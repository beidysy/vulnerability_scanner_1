import nmap
import socket

import nmap

def scan_network(target):
    # Create an Nmap PortScanner object
    nm = nmap.PortScanner()
    
    print("Scanning target:", target)
    # Scan the target
    nm.scan(target, '1-1024')  # Scanning ports 1-1024
   
    print("Scan complete. Processing results...")
    # Display scan results
    for host in nm.all_hosts():
        print(f'Host : {host} ({nm[host].hostname()})')
        print(f'State : {nm[host].state()}')
        for proto in nm[host].all_protocols():
            print('----------')
            print(f'Protocol : {proto}')
            
            lport = nm[host][proto].keys()
            for port in sorted(lport):
                print(f'Port : {port}\tState : {nm[host][proto][port]["state"]}')
    
    if not nm.all_hosts():
        print("No hosts found. Ensure the target is correct and reachable.")

def main():
    print("Simple Vulnerability Scanner using Python and Nmap")
    target = input("Enter the target IP address or network (e.g., 192.168.1.1 or 192.168.1.0/24): ")
    scan_network(target)
    
if __name__ == '__main__':
    main()
